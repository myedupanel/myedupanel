/* File: FeeReceipt.module.scss (Professional 50/50 Split) */

/* Base Styles and Fonts */
.receiptContainer {
  font-family: 'Helvetica Neue', Arial, sans-serif;
  color: #333;
  background-color: #f4f7f6;
  max-height: 85vh; 
  overflow-y: auto;
}

/* Action buttons (No Change) */
.actions {
  display: flex;
  justify-content: flex-end; 
  gap: 12px;
  padding: 12px 20px; 
  background-color: #ffffff;
  border-bottom: 1px solid #e0e0e0;
  position: sticky; 
  top: 0;
  z-index: 10;
  
  .downloadButton,
  .printButton {
    padding: 10px 20px;
    font-size: 0.9rem;
    font-weight: 600;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    background-color: #007bff;
    color: white;
    display: flex;
    align-items: center;
    gap: 8px;
  }
}

/* --- PRINTABLE RECEIPT AREA (Landscape Layout) --- */
.receiptContent {
  width: 297mm; /* A4 Landscape width */
  height: 210mm; /* A4 Landscape height */
  margin: 16px auto; 
  background-color: #ffffff; 
  box-sizing: border-box;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); 
  line-height: 1.4; 
  display: flex; /* Do hisson mein baantne ke liye */
  position: relative; /* Separator ke liye */
  overflow: hidden; /* Content overflow hide karne ke liye */
}

.receiptHalf {
  flex: 1; /* Har hissa adhi jagah lega */
  padding: 20px; /* Andar ki padding */
  box-sizing: border-box;
  font-size: 0.85rem; /* Overall font size chhota kiya */
  display: flex; /* Inner content ko flex dega */
  flex-direction: column; /* Inner content ko column mein rakhega */
  justify-content: space-between; /* Footer bottom par jayega */
  position: relative;

  .copyLabel {
      position: absolute;
      top: 50%;
      left: 0; /* Left side se bahar ki taraf */
      transform: translateY(-50%) rotate(-90deg); /* Text ko rotate karega */
      transform-origin: left center;
      white-space: nowrap;
      font-size: 0.7rem;
      font-weight: bold;
      color: #999;
      opacity: 0.7;
      letter-spacing: 1px;
  }
  &.schoolCopy .copyLabel {
      right: 0; /* Right side se bahar ki taraf */
      left: auto;
      transform: translateY(-50%) rotate(90deg); /* Text ko rotate karega */
      transform-origin: right center;
  }
}

.separator {
    width: 1px;
    background-color: #ccc;
    position: absolute;
    top: 10mm; /* Header ke baad se shuru */
    bottom: 10mm; /* Footer ke upar tak */
    left: 50%;
    transform: translateX(-50%);
    border-left: 1px dashed #ccc; /* Cutting line */
    z-index: 5;
}


/* 1. HEADER */
.header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  border-bottom: 2px solid #333; /* Double se single kiya */
  padding-bottom: 8px; /* Thoda kam kiya */
  margin-bottom: 10px; /* Thoda kam kiya */
  
  .schoolDetails {
    display: flex;
    flex-direction: column; /* Naam aur address column mein aayenge */
    align-items: flex-start;
    gap: 2px;
    h1 { font-size: 1.3rem; font-weight: 800; color: #000; margin: 0; line-height: 1.2;}
    .schoolAddress, .schoolContact, .schoolSession {
        font-size: 0.75rem; /* Font size kam kiya */
        margin: 0;
        line-height: 1.1;
    }
    .logo { max-width: 50px; max-height: 50px; margin-bottom: 5px;}
  }
  .metaHeader {
    text-align: right; /* Right align kiya */
    font-size: 0.75rem; /* Font size kam kiya */
    margin-top: 5px;
    padding-left: 10px;
    /* Border remove kiya, side by side achha nahi lagega */
    border-left: none; 
    p {
        margin: 1px 0;
        line-height: 1.2;
        white-space: nowrap;
        strong { font-weight: 600; color: #000; display: inline-block; min-width: 50px; } 
    }
  }
}

/* 2. Central Title */
.titleMeta {
  text-align: center;
  border-bottom: 1px solid #ddd;
  padding-bottom: 5px; /* Thoda kam kiya */
  margin-bottom: 10px; /* Thoda kam kiya */
  h2 { font-size: 1rem; font-weight: 800; text-transform: uppercase; color: #111; margin: 0; }
}

/* 3. Student Details */
.detailsSection {
  margin-bottom: 15px; /* Thoda kam kiya */
  
  h3 {
    font-size: 0.8rem; /* Thoda kam kiya */
    font-weight: 700;
    color: #444; 
    margin-bottom: 3px; 
    text-transform: uppercase;
    border-bottom: 1px solid #eee;
    padding-bottom: 2px;
  }
  .grid {
    display: grid;
    grid-template-columns: 1.2fr 1fr 1fr; /* Name ko thoda zyada space */
    gap: 4px 10px; /* Gap kam kiya */
    font-size: 0.8rem; /* Font size kam kiya */
    p { margin: 0; strong {font-weight: 600; color: #000;} }
  }
}

/* 4. Main Content Wrapper (Left: Table, Right: Payment) */
.mainContentWrapper {
    display: flex; 
    flex-direction: column; /* Ab yeh ek ke neeche ek aayenge */
    gap: 15px; /* Gap kam kiya */
    margin-top: 10px;
    padding-bottom: 8px; /* Thoda kam kiya */
    border-bottom: 1px solid #f0f0f0;
}
.mainContentLeft {
    flex: none; /* Ab flex use nahi hoga, poori width lega */
    width: 100%;
}
.mainContentRight {
    flex: none; /* Ab flex use nahi hoga, poori width lega */
    width: 100%;
}

/* Fee Table */
.itemsSection {
  margin-bottom: 10px;
  h3 {
    font-size: 0.8rem;
    font-weight: 700;
    color: #444;
    margin-bottom: 3px;
    text-transform: uppercase;
    border-bottom: 1px solid #eee;
    padding-bottom: 2px;
  }
}
.itemsTable {
  margin-top: 8px; /* Thoda kam kiya */
  font-size: 0.8rem; /* Thoda kam kiya */
  width: 100%; 
  border-collapse: collapse; /* Collapsing borders */

  thead tr { background-color: #f0f0f0; } 
  th, td { padding: 4px 8px; } /* Padding kam kiya */
  th { font-weight: 700; text-align: left; } /* Default text-align set */
  
  .grandTotal {
    background-color: #e6f3ff; 
    font-size: 0.85rem; 
    td { font-weight: 700; }
  }
  
  .calcRow td:nth-child(2) { text-align: right; font-weight: 600; }
  .amountCol { text-align: right; }
}

/* Payment Block */
.paymentBlock {
    h3 { font-size: 0.8rem; margin-bottom: 3px; text-transform: uppercase; }
    .grid { 
        gap: 3px 10px; /* Gap kam kiya */
        display: grid;
        grid-template-columns: 1fr;
        font-size: 0.8rem; /* Font size kam kiya */
        p { margin: 0; strong {font-weight: 600; color: #000;} }
    }
    .paidAmount {
        font-size: 0.9rem;
        color: #007bff;
    }
    .notes {
      font-style: italic;
    }
}

/* 5. BALANCE LAYOUT */
.balanceWrapper {
    display: flex;
    justify-content: center; 
    align-items: center;
    margin-top: 15px; /* Thoda kam kiya */
}

.balanceBlock {
    text-align: left; 
}

.balanceSection {
    display: flex; 
    align-items: center; 
    gap: 15px; /* Gap kam kiya */
    
    background-color: #ffffff; 
    border: 1px solid #ddd;
    padding: 8px 15px; /* Padding kam kiya */
    font-size: 0.85rem;

    p { margin: 0; } 
    strong { font-weight: 700; }
}

.balanceAmount {
  font-weight: 700;
  font-size: 0.95rem; /* Thoda kam kiya */
  &[data-balance-zero="true"] { color: #28a745; } 
  &:not([data-balance-zero="true"]) { color: #dc3545; } 
}

/* Status Badges */
.paidStamp {
  font-size: 1rem; /* Thoda kam kiya */
  font-weight: 800;
  color: #28a745;
  text-transform: uppercase;
}
.statusBadge {
  font-weight: 700;
  padding: 2px 6px; /* Padding kam kiya */
  border-radius: 3px; /* Radius kam kiya */
  font-size: 0.7rem; /* Thoda kam kiya */
  color: #fff;
  text-transform: uppercase;
  
  &.partial { background-color: #fd7e14; }
  &.pending { background-color: #ffc107; }
  &.failed { background-color: #dc3545; }
}


/* 6. Footer & Signatures */
.footer {
  margin-top: 25px; /* Thoda kam kiya */
  padding-top: 8px; /* Thoda kam kiya */
  border-top: 1px solid #ddd;
  font-size: 0.75rem; /* Thoda kam kiya */
  font-weight: 600; 
  background-color: #ffffff;
  color: #000; 
  flex-shrink: 0; /* Footer ko shrink nahi hone dega */

  .receivedBy {
    margin-bottom: 25px; /* Thoda kam kiya */
  }
  
  .signatureArea {
    display: flex;
    justify-content: space-between;
  }
  
  .signatureBox {
    border-top: 1px solid #000;
    width: 35%; 
  }
  
  .signatureLabels {
    display: flex;
    justify-content: space-between;
    padding: 0;
    
    .cashierLabel, .signatoryLabel { 
        width: 35%; 
        text-align: center; 
        font-weight: 600;
        margin: 10px 0 0 0; /* Thoda kam kiya */
    }
  }

  .footerNote { 
    text-align: center; 
    margin-top: 10px; /* Thoda kam kiya */
    font-style: normal;
    font-weight: 600; 
    color: #000; 
    background-color: #ffffff;
    padding: 5px 0; /* Padding kam kiya */
  }
}

/* --- FINAL PRINT MEDIA QUERY --- */
@media print {
    .actions { display: none !important; }
    
    body {
      margin: 0;
      padding: 0;
      background: #ffffff;
    }

    .receiptContent {
        padding: 0 !important; /* No padding on the main container */
        width: 297mm !important; /* A4 Landscape width */
        height: 210mm !important; /* A4 Landscape height */
        box-shadow: none !important;
        border: none !important;
        background-color: #ffffff !important; 
        overflow: hidden !important; /* Make sure nothing overflows */
    }

    .receiptHalf {
        padding: 10mm; /* Har copy ki andar ki padding */
        font-size: 0.75rem !important; /* Print mein font size aur kam kiya */
        justify-content: space-between; /* Footer ko bottom mein rakhega */
    }

    /* School Copy ko ulta print karein */
    .schoolCopy {
        -webkit-transform: rotate(180deg);
        -moz-transform: rotate(180deg);
        -o-transform: rotate(180deg);
        -ms-transform: rotate(180deg);
        transform: rotate(180deg);
        
        /* Rotation ke baad content ko sahi se adjust karne ke liye */
        .schoolCopyContent {
             display: flex;
             flex-direction: column;
             justify-content: space-between;
             height: 100%; /* Ensure content takes full height after rotation */
        }

        /* Upar ke text ko sahi direction mein laane ke liye */
        h1, h2, h3, p, strong, th, td, span, a, div {
             -webkit-transform: rotate(180deg);
             -moz-transform: rotate(180deg);
             -o-transform: rotate(180deg);
             -ms-transform: rotate(180deg);
             transform: rotate(180deg);
             display: block; /* Important for rotation */
             position: relative;
             /* Rotation ke baad positioning ko handle karein */
             margin: 0 auto;
             width: fit-content;
             line-height: 1.2 !important; /* Line height fix */
        }
        .header .schoolDetails { align-items: flex-end !important; } /* School details right align */
        .header .schoolDetails p { text-align: right; } /* Text align right */
        .header .schoolDetails h1 { text-align: right; } /* Text align right */
        .header .metaHeader { text-align: left !important; } /* Meta header left align */
        .header .metaHeader p { text-align: left; } /* Text align left */
        .detailsSection .grid { 
          grid-template-columns: 1fr 1fr 1.2fr !important; /* Grid order reverse */
          p:nth-child(1) { order: 3; } /* Name ko last mein */
          p:nth-child(2) { order: 2; } /* ID ko beech mein */
          p:nth-child(3) { order: 1; } /* Class ko first mein */
        }
        .detailsSection .grid p strong { float: right; } /* Labels right align */
        .itemsTable thead th, .itemsTable tbody td { text-align: right !important; }
        .itemsTable th:nth-child(2) { text-align: right !important; } /* Description right align */
        .itemsTable td:nth-child(2) { text-align: right !important; } /* Description right align */
        .itemsTable .calcRow td:nth-child(2) { text-align: left !important; } /* Subtotal text left align */
        .mainContentWrapper { 
          flex-direction: column-reverse !important; /* Order reverse kiya */
          text-align: right; /* Content ko right align */
        }
        .mainContentRight .grid p strong { float: right; } /* Payment details labels right align */
        .balanceWrapper { justify-content: center !important; } /* Center align */
        .balanceSection { flex-direction: row-reverse !important; } /* Balance order reverse */
        .balanceSection p strong { float: right; } /* Balance label right align */
        .paidStamp { -webkit-transform: rotate(180deg); transform: rotate(180deg); }
        .statusBadge { -webkit-transform: rotate(180deg); transform: rotate(180deg); }
        .footer .receivedBy { text-align: right; }
        .footer .signatureArea { flex-direction: row-reverse; } /* Signature boxes order reverse */
        .footer .signatureLabels { flex-direction: row-reverse; } /* Signature labels order reverse */
        .footer .cashierLabel { order: 2; } /* Accountant / Cashier last */
        .footer .signatoryLabel { order: 1; } /* Authorised Signatory first */
        .footer .footerNote { text-align: center; } /* Note center align */
        .copyLabel {
            transform: translateY(-50%) rotate(-90deg) !important; /* School copy label ko bhi ulta karein */
            left: 0 !important;
            right: auto !important;
            transform-origin: left center !important;
        }
    }

    .separator {
      height: calc(100% - 20mm) !important; /* Separator height fix */
      top: 10mm !important;
      bottom: 10mm !important;
    }
    
    /* Page Break Avoidance */
    section, .mainContentWrapper, .balanceWrapper, .footer, .itemsTable {
        page-break-inside: avoid !important;
        page-break-after: auto;
    }
    .footer {
        page-break-before: avoid !important;
    }
    
    /* CRUCIAL FIX: Background Colors को Forcefully White करें */
    .receiptContainer,
    .receiptContent, 
    .footer,        
    .footerNote,
    .balanceSection, 
    .itemsTable thead tr,
    .statusBadge { 
        background-color: #ffffff !important;
        color: #000 !important; 
        border: none !important; /* Print mein borders hata di */
        -webkit-print-color-adjust: exact !important; 
        print-color-adjust: exact !important;
    }
    /* Print mein colors ko override kiya */
    .balanceAmount:not([data-balance-zero="true"]) { color: #000 !important; }
    .paidStamp { color: #000 !important; }
    
    /* Footer labels को center align रखें */
    .signatureLabels .cashierLabel, .signatoryLabel {
        text-align: center !important;
    }
}